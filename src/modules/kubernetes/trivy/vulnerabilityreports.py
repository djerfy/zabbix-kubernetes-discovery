from kubernetes import client
from modules.common.functions import *
import urllib3, logging

urllib3.disable_warnings()
logging = logging.getLogger("kubernetes.trivy.vulnerabilityreports")

def trivyGetVulnerabilityreports(config=None):
    """
    description: get vulnerabilityreports data
    return: list
    """
    kubernetes = client.CustomObjectsApi()

    reports = []

    try:
        objects = kubernetes.list_cluster_custom_object(group="aquasecurity.github.io", version="v1alpha1", plural="vulnerabilityreports")
    except Exception:
        return reports

    for vuln in rawObjects(objects):
        print(vuln['metadata']['name'])
        print(vuln['report']['summary'])
