from kubernetes import client
from pyzabbix import ZabbixMetric
from modules.common.functions import *
import json, urllib3, logging

urllib3.disable_warnings()
logging = logging.getLogger("kubernetes.trivy.vulnerabilityreports")

def trivyGetVulnerabilityreports(config=None):
    """
    description: get vulnerabilityreports data
    return: list
    """
    kubernetes = client.CustomObjectsApi()

    reports = []

    for vuln in rawObjects(kubernetes.list_cluster_custom_object(group="aquasecurity.github.io", version="v1alpha1", plural="vulnerabilityreports")):
        print(vuln['metadata']['name'])
        print(vuln['report']['summary'])
